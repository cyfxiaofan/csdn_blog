{% extends './index.html' %}
{% block up %}
{% load static %}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>3Q-VIP充值</title>
    <script src='../static/js/www.js' type='text/javascript'></script>
    <link rel="stylesheet" href="../static/css/content_toolbar.css">
    <link rel="stylesheet" href="../static/css/bootstrap.min.css">
    <link rel="stylesheet" href="../static/css/avatar.css">
    <script src="../static/js/jquery-1.9.1.min.js" type="text/javascript"></script>
    <link href='../static/css/csdn_feed.css' rel='stylesheet'>
    <link  href="../static/layui/css/layui.css"  rel="stylesheet">
     <script type="text/javascript" src="../static/layui/layui.all.js"></script>
    <link href="{% static 'css/vipbutton/css/style.css' %}" rel="stylesheet" />
</head>

<body data-category="home" data-host_type="www">
    {% csrf_token %}
    {% endblock %}

{% block down %}
    <div style="margin-top: 55px">
    <div class="container clearfix" >

        <div class="row clearfix">
          <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
              <div class="card">
                  <div class="body">
                      <div class="header">

                          <h2>
                              <strong><i class="layui-icon layui-icon-star-fill" style="font-size: 25px"></i></strong>
                              <strong>VIP充值</strong>

                          </h2>

                      </div>
                      <br>
                      <form id="mainFrom" action="" method="post">
                      {% csrf_token %}
                        <!--用户名-->
                        <div style="height: 60px;">
                            <small><i class="layui-icon layui-icon-star"></i> 您的当前可用积分为：{{ user_jf }}积分</small>
                            <br>
                            <small><i class="layui-icon layui-icon-star"></i> 您的VIP到期时间为：{{ user_obj.viptime }}</small>
                            <br>
                            <small><i class="layui-icon layui-icon-star"></i> 积分获取：发表博客（2/分），发表评论（1/分），收藏博客（1/分），点赞博客（1/分）</small>
                        </div>
                      <div class="row clearfix">
                          <div class="col-md-10">
                            <p>
                              <b>请选择充值时长</b>

                            </p>

                          <div class="col-md-12">
                                <div style="height: 50px">

                                </div>
                                <div class="aui-current-box" style="background-color: rgb(245,246,247)">
                                    <a style="text-decoration: none;" class="aui-current-item this-card">
                                        <!-- <div class="aui-reset-tag"><img src="images/tag.png" alt=""></div> -->
                                        <div class="aui-current-item-hd">
                                            <h1>30天</h1>
                                            <h2 style="margin-top: 8px">促销价:30.00</h2>
{#                                            <h3>原价:29.99</h3>#}
                                        </div>
                                    </a>
                                    <a style="text-decoration: none;" class="aui-current-item">

                                        <div class="aui-current-item-hd">
                                            <h1>90天</h1>
                                            <h2 style="margin-top: 8px">促销价:90.00</h2>
{#                                            <h2>促销价:29.01</h2>#}
{#                                            <h3>原价:29.99</h3>#}
                                        </div>
                                    </a>
                                    <a style="text-decoration: none;" class="aui-current-item ">

                                        <div class="aui-current-item-hd">
                                            <h1>180天</h1>
                                            <h2 style="margin-top: 8px">促销价:180.00</h2>
{#                                            <h2>促销价:29.01</h2>#}
{#                                            <h3>原价:29.99</h3>#}
                                        </div>
                                    </a>
                                    <a style="text-decoration: none;" class="aui-current-item">
                                        <div class="aui-current-item-hd">
                                            <h1>365天</h1>
                                            <h2 style="margin-top: 8px">促销价:365.00</h2>
{#                                            <h2>促销价:29.01</h2>#}
{#                                            <h3>原价:29.99</h3>#}
                                        </div>
                                    </a>

                                    <a id="finally" style="text-decoration: none;" class="aui-current-item ">
                                        <div class="aui-current-item-hd">
                                            <h1 id="inputtext">自定义</h1>
                                            <h3 style="margin-top: 6px">自定义天数</h3>
                                        </div>
                                    </a>


                                <div class="clearfix"></div>
                            </div>

                              <input type="text"  name="vipdays"  value="30" style="display: none">
                              </div>

                          </div>
                      </div>

                          <div class="row clearfix">
                              <p>
                              <b>共需支付：</b>
                              <b class="total_price">30</b>
                              <b>积分</b>

                            </p>
                          </div>

                        <div style="height: 50px"></div>
                      <div class="row clearfix">
                          <div class="col-md-12">
                              <a type="button" id="submin_btn" class="layui-btn  layui-btn-warm" style="color: black;width: 100%">&nbsp;充值</a>
                          </div>
                      </div>

                      </form>
                  </div>
              </div>
          </div>
      </div>

    </div>
    </div>

</body>
<script src='../static/js/modernizr.js' type='text/javascript'></script>
<script src="../static/js/bootstrap.min.js" type="text/javascript"></script>
<script type="text/javascript" src="../static/js/user-tooltip.js"></script>


<script src='../static/js/publib_footer-1.0.3.js' data-isfootertrack="false"></script>
<script src='../static/js/csdn_feed.min.js' type='text/javascript'></script>
<script src="../static/js/side-toolbar.js"></script>
<script type="text/javascript">{{ jscode|default:"" |safe }}</script>
 <script>
    var checkuser = false;
    var checkvip = 30;
    $('.aui-current-item').click(function(e){

		$(this).addClass('this-card').siblings().removeClass('this-card');

		$('#type-amount').html($(this).find('.cardAmount').html());

		checkvip = $(this).find('h1').html().replace(/[^\d]/g,'');
		$('[name=vipdays]').val(checkvip);
		console.log(checkvip);
		var total_price = Number(checkvip);
        $('.total_price').text(total_price)

	});

	$('#finally').click(function(){
		var inp = $('<input type="text" class="nb" onkeyup="value=value.replace(/[^\\d]/g,\'\')" >');
		if ($('.nb').val() == '' || $('.nb').val()){

		}else{
		    //激活编辑框并获得焦点
			$(this).find('h1').html(inp);
            $('.nb').focus()
		}

		inp.blur(function(){
		    checkvip = $('.nb').val();
		    $('[name=vipdays]').val(checkvip);
		    $('.total_price').text(checkvip);
			var thisval = $('.nb').val()+'天';
			if($('.nb').val() != '' && $('.nb').val() != 0 ){
                $('#inputtext').html(thisval)
            }else{
			    $('#inputtext').html('自定义')
                checkvip = false;
            }
		})
	});




    //提交按钮
    $('#submin_btn').click(function () {
        if('{{ request.session.userinfo.username }}'){
            checkuser = true
        }
        if(checkuser && checkvip){
            $('#mainFrom').submit()
        }
        else if(checkvip == false){
            layer.msg('vip天数有误！请检查并重新选择！')
        }else {
            layer.msg('请先登陆！')
        }
    })

    </script>
</html>
{% endblock %}